<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Movies</title>
<style>
body{margin:0;font-family:Arial,sans-serif;background:#141414;color:#fff}
header{background:#141414;padding:15px;display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;z-index:10}
header h1{color:#e50914;margin:0;font-size:18px}
input[type="text"]{padding:6px;font-size:14px;width:150px;border-radius:4px;border:none}
section{margin-top:15px}
h2{margin-left:10px;font-size:16px}
.carousel-wrapper{position:relative}
.carousel{display:flex;overflow-x:auto;gap:8px;padding:15px;scroll-behavior:smooth;cursor:grab}
.carousel::-webkit-scrollbar{display:none}
.movie-card{min-width:120px;cursor:pointer;position:relative;transition:transform .2s;flex-shrink:0}
.movie-card img{width:100%;border-radius:6px;display:block}
.movie-title{position:absolute;bottom:3px;left:3px;right:3px;background:rgba(0,0,0,.7);padding:1px 3px;font-size:12px;border-radius:4px;text-align:center}
.preview-card{display:none!important}
.arrow{display:none} /* hide arrows on mobile */
</style>
</head>
<body>
<header>
  <h1>Movies</h1>
  <input type="text" id="search" placeholder="Search...">
</header>

<section>
  <h2>Trending Now</h2>
  <div class="carousel-wrapper">
      <div class="carousel" id="trending"></div>
  </div>

  <h2>Top 10</h2>
  <div class="carousel-wrapper">
      <div class="carousel" id="top10"></div>
  </div>

  <h2>My List</h2>
  <div class="carousel-wrapper">
      <div class="carousel" id="mylist"></div>
  </div>
</section>

<script defer>
const API_KEY="8924320c";
let myList=[];
const trendingTitles=["Avengers: Endgame","Joker","Spider-Man: No Way Home","Black Panther","Doctor Strange"];
const top10Titles=["Inception","Interstellar","The Dark Knight","Fight Club","Pulp Fiction","Forrest Gump","The Matrix","The Godfather","The Lord of the Rings","Gladiator"];

// fetch movies in parallel
async function fetchMovies(titles){
  try{
    const results=await Promise.all(titles.map(title=>
      fetch(`https://www.omdbapi.com/?apikey=${API_KEY}&t=${encodeURIComponent(title)}`).then(r=>r.json())
    ));
    return results.filter(m=>m.Response==="True").map(m=>({
      title:m.Title,imdb:m.imdbID,poster:m.Poster,plot:m.Plot
    }));
  }catch(e){console.error(e);return []}
}

// render carousel for mobile
function renderCarousel(movies,containerId){
  const container=document.getElementById(containerId);
  container.innerHTML=movies.map(movie=>`
    <div class="movie-card">
      <img src="${movie.poster}" alt="${movie.title}" loading="lazy">
      <div class="movie-title">${movie.title}</div>
    </div>
  `).join("");

  container.querySelectorAll(".movie-card").forEach(card=>{
    card.onclick=()=>window.open(`https://vidrock.net/movie/${movies.find(m=>m.title===card.querySelector(".movie-title").innerText).imdb}`,"_blank");
  });
}

// enable swipe
function addSwipe(id){
  const slider=document.getElementById(id);
  let isDown=false,startX,scrollLeft;
  slider.addEventListener("pointerdown",e=>{isDown=true;startX=e.pageX-slider.offsetLeft;scrollLeft=slider.scrollLeft});
  slider.addEventListener("pointerleave",()=>isDown=false);
  slider.addEventListener("pointerup",()=>isDown=false);
  slider.addEventListener("pointermove",e=>{
    if(!isDown)return;
    e.preventDefault();
    slider.scrollLeft=scrollLeft-(e.pageX-startX)*2;
  });
}

async function initMovies(){
  const [trendingMovies,top10Movies]=await Promise.all([
    fetchMovies(trendingTitles),
    fetchMovies(top10Titles)
  ]);
  renderCarousel(trendingMovies,"trending");
  renderCarousel(top10Movies,"top10");
  renderCarousel(myList,"mylist");
  ["trending","top10","mylist"].forEach(addSwipe);
}
initMovies();

// search
document.getElementById("search").addEventListener("keypress",function(e){
  if(e.key==="Enter"){
    const q=e.target.value.trim();
    if(!q)return;
    fetch(`https://www.omdbapi.com/?apikey=${API_KEY}&s=${encodeURIComponent(q)}`)
      .then(r=>r.json())
      .then(d=>{if(d.Search&&d.Search.length>0)window.open(`https://vidrock.net/movie/${d.Search[0].imdbID}`,"_blank");else alert("Movie not found!")})
      .catch(console.error);
  }
});
</script>
</body>
</html>
