<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Movies</title>
<style>
body{margin:0;font-family:Arial,sans-serif;background:#141414;color:#fff}
header{background:#141414;padding:20px;display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;z-index:10}
header h1{color:#e50914;margin:0}
input[type="text"]{padding:8px;font-size:16px;width:300px;border-radius:4px;border:none}
section{margin-top:20px}
h2{margin-left:20px}
.carousel-wrapper{position:relative}
.carousel{display:flex;overflow-x:auto;gap:10px;padding:20px;scroll-behavior:smooth;cursor:grab}
.carousel::-webkit-scrollbar{display:none}
.movie-card{min-width:150px;cursor:pointer;position:relative;transition:transform .3s;flex-shrink:0}
.movie-card img{width:100%;border-radius:8px;display:block}
.movie-card:hover{transform:scale(1.2);z-index:5}
.movie-title{position:absolute;bottom:5px;left:5px;right:5px;background:rgba(0,0,0,.7);padding:2px 4px;font-size:14px;border-radius:4px;text-align:center}
.preview-card{position:absolute;top:-240px;left:50%;transform:translateX(-50%);width:300px;background:#222;padding:10px;border-radius:8px;display:none;flex-direction:column;z-index:10;transition:all .3s}
.preview-card img{width:100%;border-radius:8px}
.preview-card h3{margin:5px 0;font-size:16px}
.preview-card p{font-size:14px;color:#ccc}
.preview-card .buttons{display:flex;gap:10px;margin-top:5px}
.preview-card button{flex:1;padding:5px;font-size:14px;border:none;border-radius:4px;cursor:pointer}
.preview-card .play{background:#e50914;color:#fff}
.preview-card .add{background:#444;color:#fff}
.preview-card .remove{background:#888;color:#fff}
.arrow{position:absolute;top:50%;transform:translateY(-50%);font-size:40px;color:rgba(255,255,255,.7);background:rgba(0,0,0,.4);border-radius:50%;padding:5px 10px;cursor:pointer;z-index:5;user-select:none}
.arrow:hover{color:#fff;background:rgba(0,0,0,.7)}
.left-arrow{left:10px}
.right-arrow{right:10px}
iframe{display:none}
@media(max-width:768px){
  input[type="text"]{width:150px}
  .movie-card{min-width:120px}
  .preview-card{display:none!important}
}
</style>
</head>
<body>
<header>
  <h1>Movies</h1>
  <input type="text" id="search" placeholder="Search movies...">
</header>

<section>
  <h2>Trending Now</h2>
  <div class="carousel-wrapper">
      <div class="arrow left-arrow" onclick="scrollCarousel('trending',-300)">&#10094;</div>
      <div class="arrow right-arrow" onclick="scrollCarousel('trending',300)">&#10095;</div>
      <div class="carousel" id="trending"></div>
  </div>

  <h2>Top 10</h2>
  <div class="carousel-wrapper">
      <div class="arrow left-arrow" onclick="scrollCarousel('top10',-300)">&#10094;</div>
      <div class="arrow right-arrow" onclick="scrollCarousel('top10',300)">&#10095;</div>
      <div class="carousel" id="top10"></div>
  </div>

  <h2>My List</h2>
  <div class="carousel-wrapper">
      <div class="arrow left-arrow" onclick="scrollCarousel('mylist',-300)">&#10094;</div>
      <div class="arrow right-arrow" onclick="scrollCarousel('mylist',300)">&#10095;</div>
      <div class="carousel" id="mylist"></div>
  </div>
</section>

<script defer>
const API_KEY="8924320c";
let myList=[];
const trendingTitles=["Avengers: Endgame","Joker","Spider-Man: No Way Home","Black Panther","Doctor Strange"];
const top10Titles=["Inception","Interstellar","The Dark Knight","Fight Club","Pulp Fiction","Forrest Gump","The Matrix","The Godfather","The Lord of the Rings","Gladiator"];

async function fetchMovies(titles){
  try{
    const results=await Promise.all(titles.map(title=>
      fetch(`https://www.omdbapi.com/?apikey=${API_KEY}&t=${encodeURIComponent(title)}`).then(r=>r.json())
    ));
    return results.filter(m=>m.Response==="True").map(m=>({
      title:m.Title,imdb:m.imdbID,poster:m.Poster,plot:m.Plot
    }));
  }catch(e){console.error(e);return []}
}

function renderCarousel(movies,containerId){
  const container=document.getElementById(containerId);
  container.innerHTML=movies.map(movie=>`
    <div class="movie-card">
      <img src="${movie.poster}" alt="${movie.title}" loading="lazy">
      <div class="movie-title">${movie.title}</div>
      <div class="preview-card">
        <img src="${movie.poster}" alt="${movie.title}" loading="lazy">
        <h3>${movie.title}</h3>
        <p>${movie.plot}</p>
        <div class="buttons">
          <button class="play" data-id="${movie.imdb}">Play</button>
          ${containerId==="mylist"
            ?`<button class="remove" data-id="${movie.imdb}">Remove</button>`
            :`<button class="add" data-id="${movie.imdb}">Add to List</button>`}
        </div>
      </div>
    </div>
  `).join("");

  container.querySelectorAll(".movie-card").forEach(card=>{
    const preview=card.querySelector(".preview-card");
    card.onmouseenter=()=>preview.style.display="flex";
    card.onmouseleave=()=>preview.style.display="none";
  });

  container.querySelectorAll(".play").forEach(btn=>{
    btn.onclick=e=>window.open(`https://vidrock.net/movie/${e.target.dataset.id}`,"_blank");
  });
  container.querySelectorAll(".add").forEach(btn=>{
    btn.onclick=e=>{
      const movie=movies.find(m=>m.imdb===e.target.dataset.id);
      if(!myList.some(m=>m.imdb===movie.imdb)){
        myList.push(movie);
        renderCarousel(myList,"mylist");
      }
    };
  });
  container.querySelectorAll(".remove").forEach(btn=>{
    btn.onclick=e=>{
      myList=myList.filter(m=>m.imdb!==e.target.dataset.id);
      renderCarousel(myList,"mylist");
    };
  });
}

function scrollCarousel(id,amount){
  document.getElementById(id).scrollBy({left:amount,behavior:"smooth"});
}

function addSwipe(id){
  const slider=document.getElementById(id);
  let isDown=false,startX,scrollLeft;
  slider.addEventListener("pointerdown",e=>{
    isDown=true;slider.style.cursor="grabbing";
    startX=e.pageX-slider.offsetLeft;scrollLeft=slider.scrollLeft;
  });
  slider.addEventListener("pointerleave",()=>{isDown=false;slider.style.cursor="grab"});
  slider.addEventListener("pointerup",()=>{isDown=false;slider.style.cursor="grab"});
  slider.addEventListener("pointermove",e=>{
    if(!isDown)return;
    e.preventDefault();
    const x=e.pageX-slider.offsetLeft;
    slider.scrollLeft=scrollLeft-(x-startX)*2;
  });
}

async function initMovies(){
  const [trendingMovies,top10Movies]=await Promise.all([
    fetchMovies(trendingTitles),
    fetchMovies(top10Titles)
  ]);
  renderCarousel(trendingMovies,"trending");
  renderCarousel(top10Movies,"top10");
  renderCarousel(myList,"mylist");
  ["trending","top10","mylist"].forEach(addSwipe);
}
initMovies();

// Search
document.getElementById("search").addEventListener("keypress",function(e){
  if(e.key==="Enter"){
    const query=e.target.value.trim();
    if(!query)return;
    fetch(`https://www.omdbapi.com/?apikey=${API_KEY}&s=${encodeURIComponent(query)}`)
      .then(res=>res.json())
      .then(data=>{
        if(data.Search&&data.Search.length>0){
          window.open(`https://vidrock.net/movie/${data.Search[0].imdbID}`,"_blank");
        }else alert("Movie not found!");
      }).catch(console.error);
  }
});
</script>
</body>
</html>
